"""Base class for post-exploitation modules."""
from abc import ABC, abstractmethod
from typing import Dict, Any


class BasePostExploitationModule(ABC):
    """
    Abstract base class for all post-exploitation modules.
    
    Each module must implement the execute() method which performs
    the actual post-exploitation work on a remote host.
    """
    
    @property
    @abstractmethod
    def name(self) -> str:
        """Return the unique name of the module."""
        pass
    
    @property
    @abstractmethod
    def description(self) -> str:
        """Return a brief description of what the module does."""
        pass
    
    @abstractmethod
    async def execute(self, ssh_session, output_dir: str) -> Dict[str, Any]:
        """
        Execute the post-exploitation module on the given SSH session.
        
        Args:
            ssh_session: An active SSHSession instance to the target host
            output_dir: Directory where output files should be saved
            
        Returns:
            Dictionary containing module execution results with keys:
                - success: bool indicating if execution was successful
                - data: Any data collected by the module
                - error: Error message if execution failed
        """
        pass
